/* eslint-disable @typescript-eslint/no-explicit-any */\n'use client';\n\nimport { useRef, useState, useEffect } from 'react';\nimport * as THREE from 'three';\nimport { GLTFLoader } from 'three/examples/jsm/loaders/GLTFLoader.js';\nimport { OrbitControls } from 'three/examples/jsm/controls/OrbitControls.js';\n\ninterface DebugARViewerProps {\n  modelPath: string;\n  deviceType: 'mobile' | 'desktop';\n}\n\nexport default function DebugARViewer({ modelPath, deviceType }: DebugARViewerProps) {\n  const [logs, setLogs] = useState<string[]>(['ğŸ¬ ë””ë²„ê¹… ì‹œì‘...']);\n  const [status, setStatus] = useState<'loading' | 'success' | 'error'>('loading');\n  const containerRef = useRef<HTMLDivElement>(null);\n  \n  const addLog = (message: string) => {\n    const timestamp = new Date().toLocaleTimeString();\n    const logMessage = `[${timestamp}] ${message}`;\n    console.log(logMessage);\n    setLogs(prev => [...prev.slice(-10), logMessage]); // ìµœê·¼ 10ê°œë§Œ ìœ ì§€\n  };\n\n  useEffect(() => {\n    if (!containerRef.current) return;\n    \n    addLog(`ë””ë°”ì´ìŠ¤ íƒ€ì…: ${deviceType}`);\n    addLog('ì»¨í…Œì´ë„ˆ DOM ì¤€ë¹„ ì™„ë£Œ');\n    \n    if (deviceType === 'mobile') {\n      initializeMobileDebug();\n    } else {\n      initializeDesktopDebug();\n    }\n  }, [deviceType]);\n\n  const initializeMobileDebug = async () => {\n    try {\n      addLog('ğŸ“± ëª¨ë°”ì¼ ëª¨ë“œ ì‹œì‘');\n      \n      // ì¹´ë©”ë¼ ê¶Œí•œ ì²´í¬\n      addLog('ì¹´ë©”ë¼ ê¶Œí•œ í™•ì¸ ì¤‘...');\n      if (!navigator?.mediaDevices?.getUserMedia) {\n        throw new Error('ì¹´ë©”ë¼ API ì§€ì›í•˜ì§€ ì•ŠìŒ');\n      }\n      \n      // MindAR ë¼ì´ë¸ŒëŸ¬ë¦¬ ì²´í¬\n      addLog('MindAR ë¼ì´ë¸ŒëŸ¬ë¦¬ í™•ì¸ ì¤‘...');\n      if (!(window as any).MindARThree) {\n        throw new Error('MindAR ë¼ì´ë¸ŒëŸ¬ë¦¬ ë¡œë“œë˜ì§€ ì•ŠìŒ');\n      }\n      addLog('âœ… MindAR ë¼ì´ë¸ŒëŸ¬ë¦¬ í™•ì¸ë¨');\n      \n      // WebGL ì§€ì› ì²´í¬\n      const canvas = document.createElement('canvas');\n      const gl = canvas.getContext('webgl2') || canvas.getContext('webgl');\n      if (!gl) {\n        throw new Error('WebGL ì§€ì›í•˜ì§€ ì•ŠìŒ');\n      }\n      addLog('âœ… WebGL ì§€ì› í™•ì¸ë¨');\n      \n      // ë§ˆì»¤ íŒŒì¼ ì²´í¬\n      addLog('ë§ˆì»¤ íŒŒì¼ í™•ì¸ ì¤‘...');\n      const response = await fetch('/markers/qr-marker.mind');\n      if (!response.ok) {\n        throw new Error(`ë§ˆì»¤ íŒŒì¼ ë¡œë“œ ì‹¤íŒ¨: ${response.status}`);\n      }\n      addLog('âœ… ë§ˆì»¤ íŒŒì¼ í™•ì¸ë¨');\n      \n      // GLB ëª¨ë¸ íŒŒì¼ ì²´í¬\n      addLog('GLB ëª¨ë¸ íŒŒì¼ í™•ì¸ ì¤‘...');\n      const modelResponse = await fetch(modelPath);\n      if (!modelResponse.ok) {\n        throw new Error(`GLB ëª¨ë¸ ë¡œë“œ ì‹¤íŒ¨: ${modelResponse.status}`);\n      }\n      addLog('âœ… GLB ëª¨ë¸ íŒŒì¼ í™•ì¸ë¨');\n      \n      // three-icosa ë¼ì´ë¸ŒëŸ¬ë¦¬ ì²´í¬\n      try {\n        const threeIcosaModule = await import('three-icosa');\n        addLog('âœ… three-icosa ë¼ì´ë¸ŒëŸ¬ë¦¬ ë¡œë“œë¨');\n      } catch (icosaError) {\n        addLog(`âš ï¸ three-icosa ë¡œë“œ ì‹¤íŒ¨: ${icosaError}`);\n      }\n      \n      addLog('ğŸ‰ ëª¨ë“  ì²´í¬ ì™„ë£Œ - AR ì´ˆê¸°í™” ê°€ëŠ¥!');\n      setStatus('success');\n      \n    } catch (error) {\n      addLog(`âŒ ì—ëŸ¬: ${error}`);\n      setStatus('error');\n    }\n  };\n\n  const initializeDesktopDebug = async () => {\n    try {\n      addLog('ğŸ–¥ï¸ ë°ìŠ¤í¬í†± ëª¨ë“œ ì‹œì‘');\n      \n      // Three.js ê¸°ë³¸ ê¸°ëŠ¥ ì²´í¬\n      const scene = new THREE.Scene();\n      const camera = new THREE.PerspectiveCamera(75, window.innerWidth / window.innerHeight, 0.1, 1000);\n      const renderer = new THREE.WebGLRenderer();\n      addLog('âœ… Three.js ê¸°ë³¸ ê°ì²´ ìƒì„±ë¨');\n      \n      // GLB ë¡œë” ì²´í¬\n      const loader = new GLTFLoader();\n      addLog('âœ… GLTF ë¡œë” ìƒì„±ë¨');\n      \n      addLog('ğŸ‰ ë°ìŠ¤í¬í†± ëª¨ë“œ ì²´í¬ ì™„ë£Œ!');\n      setStatus('success');\n      \n    } catch (error) {\n      addLog(`âŒ ì—ëŸ¬: ${error}`);\n      setStatus('error');\n    }\n  };\n\n  return (\n    <div className=\"min-h-screen bg-black text-white p-4\">\n      <div className=\"max-w-2xl mx-auto\">\n        <h1 className=\"text-xl font-bold mb-4\">ğŸ”§ AR ë·°ì–´ ë””ë²„ê·¸ ëª¨ë“œ</h1>\n        \n        <div className=\"mb-4\">\n          <div className=\"flex items-center gap-2 mb-2\">\n            <span>ìƒíƒœ:</span>\n            <span className={`px-2 py-1 rounded text-xs ${\n              status === 'loading' ? 'bg-yellow-600' :\n              status === 'success' ? 'bg-green-600' : 'bg-red-600'\n            }`}>\n              {status === 'loading' ? 'ğŸ”„ ì²´í¬ ì¤‘' :\n               status === 'success' ? 'âœ… ì„±ê³µ' : 'âŒ ì‹¤íŒ¨'}\n            </span>\n          </div>\n          <div>ë””ë°”ì´ìŠ¤: {deviceType}</div>\n          <div>ëª¨ë¸ ê²½ë¡œ: {modelPath}</div>\n        </div>\n        \n        <div className=\"bg-gray-900 rounded p-4 h-96 overflow-y-auto\">\n          <h2 className=\"font-bold mb-2\">ë””ë²„ê·¸ ë¡œê·¸:</h2>\n          {logs.map((log, index) => (\n            <div key={index} className=\"text-sm font-mono mb-1 break-words\">\n              {log}\n            </div>\n          ))}\n        </div>\n        \n        <div className=\"mt-4\">\n          <a \n            href=\"/ar/view/1\" \n            className=\"inline-block bg-blue-600 hover:bg-blue-700 px-4 py-2 rounded\"\n          >\n            â† ì›ë˜ AR ë·°ì–´ë¡œ ëŒì•„ê°€ê¸°\n          </a>\n        </div>\n      </div>\n      \n      <div ref={containerRef} className=\"hidden\" />\n    </div>\n  );\n}\n